<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>滚动与缩放的图片浏览</title>
    <style>
        body, html {
            margin: 0;
            padding: 0;
            height: 100%;
            overflow: hidden;
            width: 100vw;
        }

        .split {
            display: flex;
            flex-direction: column;
            height: 100%;
        }

        .top {
            flex: 1;
            overflow-y: auto;
            overflow-x: hidden;
            -webkit-overflow-scrolling: touch;
            width: 100%;
        }

        .bottom {
            flex: 1;
            overflow-y: auto;
            -webkit-overflow-scrolling: touch;
            padding: 0;
            width: 100%;
        }

        .content {
            padding: 0;
            font-size: 1em;
            line-height: 1.4;
            white-space: pre-wrap;
        }

        .image-container {
            padding: 0; /* 去掉内边距 */
            margin: 0; /* 去掉外边距 */
        }

        .image {
            display: block;
            position: relative;
            left: 50%;
            transform: translateX(-50%);
            transition: transform 0.1s ease-out;
            margin: 0;
        }

        .slider-container {
            position: fixed;
            width: 90%;
            max-width: 500px;
            padding: 15px;
        }

        .slider {
            width: 100%;
        }

        .slider-bottom {
            bottom: 10px;
        }

        .scroll-bottom {
            bottom: 10px;
        }

        .hidden {
            display: none;
        }
        
    </style>
</head>
<body>
    <div class="split">
        <!-- 上半部分显示亚里亚 -->
        <div class="top" id="top">
            <div class="content">
                <p>绯弹的亚莉亚(绯弹的亚里亚)


作者：赤松中学





第一卷 序

第三十四卷 早天的响导舰 插图





</p>
            </div>
        </div>

        <!-- 下半部分显示图片 -->
        <div class="bottom" id="bottom">
            <div class="image-container" id="image-container-bottom">
                <!-- 动态生成下半部分的图片 -->
            </div>
        </div>
    </div>

    <div class="slider-container slider-bottom">
        <input type="range" min="100" max="150" value="100" class="slider" id="slider-bottom">
    </div>

    <script>
        let lockedScrollRatioBottom = null;

        function updateImageTransform(container, slider, isTop) {
            const width = window.innerWidth;
            const images = container.querySelectorAll('.image');
            const scrollContainer = isTop ? document.getElementById('top') : document.getElementById('bottom');

            // 使用锁定的滚动比值
            let scrollRatio = isTop ? lockedScrollRatioTop : lockedScrollRatioBottom;

            if (scrollRatio !== null) {
                scrollRatio = parseFloat(scrollRatio).toFixed(4);
            }

            const imageWidth = (slider.value / 100) * width;
            images.forEach(image => {
                image.style.width = `${imageWidth}px`;
            });

            if (scrollRatio !== null) {
                requestAnimationFrame(() => {
                    scrollContainer.scrollTop = scrollRatio * (scrollContainer.scrollHeight - scrollContainer.clientHeight);
                });
            }
        }

        function updateScrollIndicators() {
            
            const bottom = document.getElementById('bottom');

            
            const bottomRatio = (bottom.scrollTop / (bottom.scrollHeight - bottom.clientHeight)).toFixed(4);

            
            document.getElementById('scroll-bottom-indicator').textContent = `滚动比例: ${bottomRatio}`;
        }
        
        function lockScrollRatio(isTop) {
            const scrollContainer = isTop ? document.getElementById('top') : document.getElementById('bottom');
            const ratio = (scrollContainer.scrollTop / (scrollContainer.scrollHeight - scrollContainer.clientHeight)).toFixed(4);
            
            if (isTop) {
                lockedScrollRatioTop = ratio;
            } else {
                lockedScrollRatioBottom = ratio;
            }
        }

        function unlockScrollRatio(isTop) {
            if (isTop) {
                lockedScrollRatioTop = null;
            } else {
                lockedScrollRatioBottom = null;
            }
        }

        
         // 恢复滚动位置
        window.onload = function() {
            document.getElementById('top').scrollTop = localStorage.getItem('topScroll') || 0;
            document.getElementById('bottom').scrollTop = localStorage.getItem('bottomScroll') || 0;
            document.getElementById('slider-bottom').value = localStorage.getItem('sliderBottomValue') || 125;
            updateImageTransform(document.getElementById('image-container-bottom'), document.getElementById('slider-bottom'), false);

        };

        // 保存滚动位置
        document.getElementById('top').onscroll = function() {
            localStorage.setItem('topScroll', this.scrollTop);
        };
        

        // 动态生成下半部分图片列表
        const imageContainerBottom = document.getElementById('image-container-bottom');
        for (let i = 1; i <= 234; i++) {
            const img = document.createElement('img');
            img.src = `File ${String(i).padStart(5, '0')}.jpeg`;
            img.alt = `Image ${i}`;
            img.className = 'image';
            imageContainerBottom.appendChild(img);
        }
    </script>
</body>
</html>
